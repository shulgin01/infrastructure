name: "main"
on: [workflow_dispatch, push]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '16'

      - name: "Install dependencies"
        run: npm install

      - run: npm run ts
      - run: npm run lint
      - run: npm run test
      - run: node release.js

  release:
    runs-on: ubuntu-latest
    if: github.ref_type == 'tag'
    needs: test
    steps:
        - uses: actions/checkout@v3
        - uses: actions/setup-node@v3
          with:
            node-version: '16'

        - name: "Install dependencies"
          run: npm install

        - name: "Update ticket"
          run: node release.js